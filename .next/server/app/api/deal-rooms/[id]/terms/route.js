"use strict";(()=>{var e={};e.id=2462,e.ids=[2462],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},93085:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>p,staticGenerationAsyncStorage:()=>l});var o={};r.r(o),r.d(o,{PUT:()=>u});var s=r(73278),a=r(45002),n=r(54877),i=r(71309),d=r(95594);async function u(e,{params:t}){try{let r=t.id,{terms:o,userId:s,userName:a,userRole:n}=await e.json();if(!r||!o||!s||!a||!n)return i.NextResponse.json({error:"Missing required fields"},{status:400});let u=await (0,d.O_)(r,o,s,a,n);return i.NextResponse.json(u)}catch(e){return console.error("Error updating deal terms:",e),i.NextResponse.json({error:"Failed to update deal terms"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/deal-rooms/[id]/terms/route",pathname:"/api/deal-rooms/[id]/terms",filename:"route",bundlePath:"app/api/deal-rooms/[id]/terms/route"},resolvedPagePath:"/Users/mac/Downloads/VentureHiveIntelligence/src/app/api/deal-rooms/[id]/terms/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:p}=m,h="/api/deal-rooms/[id]/terms/route";function g(){return(0,n.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:l})}},95594:(e,t,r)=>{async function o(e,t,r,o,s,a,n){try{let i=new Date().toISOString(),d=`dr-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,u={id:`msg-${Date.now()}`,senderId:"system",senderName:"System",senderRole:"founder",content:`Deal room created between ${o} (Founder) and ${a} (Investor) for project "${t}".`,timestamp:i,isSystemMessage:!0},m={id:`act-${Date.now()}`,type:"user_joined",userId:"system",userName:"System",userRole:"founder",timestamp:i,details:{message:`Deal room created for project "${t}"`}};return{id:d,projectId:e,projectName:t,founderUserId:r,founderName:o,investorUserId:s,investorName:a,createdAt:i,updatedAt:i,status:"pending",terms:n||{},messages:[u],activities:[m],documents:[],isArchived:!1,lastActivity:i}}catch(e){throw console.error("Error creating deal room:",e),Error("Failed to create deal room")}}async function s(e){try{return null}catch(e){throw console.error("Error fetching deal room:",e),Error("Failed to fetch deal room")}}async function a(e,t,r){try{return[]}catch(e){throw console.error("Error fetching user deal rooms:",e),Error("Failed to fetch user deal rooms")}}async function n(e,t,r,o,a){try{let n=await s(e);if(!n)throw Error("Deal room not found");if("founder"===a&&n.founderUserId!==r||"investor"===a&&n.investorUserId!==r)throw Error("You do not have permission to update this deal room");let i=new Date().toISOString(),d={id:`act-${Date.now()}`,type:"term_update",userId:r,userName:o,userRole:a,timestamp:i,details:{previousTerms:n.terms,newTerms:t}},u={id:`msg-${Date.now()}`,senderId:"system",senderName:"System",senderRole:"founder",content:`${o} (${a}) updated the deal terms.`,timestamp:i,isSystemMessage:!0};return{...n,terms:t,activities:[...n.activities,d],messages:[...n.messages,u],updatedAt:i,lastActivity:i}}catch(e){throw console.error("Error updating deal terms:",e),Error("Failed to update deal terms")}}async function i(e,t,r,o,a){try{let n=await s(e);if(!n)throw Error("Deal room not found");if("founder"===a&&n.founderUserId!==r||"investor"===a&&n.investorUserId!==r)throw Error("You do not have permission to update this deal room");let i=new Date().toISOString(),d={id:`act-${Date.now()}`,type:"status_change",userId:r,userName:o,userRole:a,timestamp:i,details:{previousStatus:n.status,newStatus:t}},u={id:`msg-${Date.now()}`,senderId:"system",senderName:"System",senderRole:"founder",content:`${o} (${a}) changed the deal status from ${n.status} to ${t}.`,timestamp:i,isSystemMessage:!0};return{...n,status:t,activities:[...n.activities,d],messages:[...n.messages,u],updatedAt:i,lastActivity:i}}catch(e){throw console.error("Error updating deal status:",e),Error("Failed to update deal status")}}async function d(e,t,r,o,a,n){try{let i=await s(e);if(!i)throw Error("Deal room not found");if("founder"===o&&i.founderUserId!==t||"investor"===o&&i.investorUserId!==t)throw Error("You do not have permission to send messages in this deal room");let d=new Date().toISOString(),u={id:`msg-${Date.now()}`,senderId:t,senderName:r,senderRole:o,content:a,timestamp:d,isSystemMessage:!1,attachments:n};return[...i.messages],u}catch(e){throw console.error("Error sending message:",e),Error("Failed to send message")}}async function u(e,t,r){try{let o=await s(e);if(!o)throw Error("Deal room not found");if(o.founderUserId!==t&&o.investorUserId!==t)throw Error("You do not have permission to archive/unarchive this deal room");return{...o,isArchived:r,updatedAt:new Date().toISOString()}}catch(e){throw console.error("Error toggling archive status:",e),Error("Failed to update deal room archive status")}}r.d(t,{Hn:()=>o,Ii:()=>u,O_:()=>n,ZE:()=>a,bG:()=>d,dN:()=>s,wc:()=>i})}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[7787,4833],()=>r(93085));module.exports=o})();